<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Action (yuujinchou.Yuujinchou.Action)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.2"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../../index.html">yuujinchou</a> &#x00BB; <a href="../index.html">Yuujinchou</a> &#x00BB; Action</nav><h1>Module <code>Yuujinchou.Action</code></h1><p>The <a href="index.html"><code>Action</code></a> module implements the engine running the patterns.</p><nav class="toc"><ul><li><a href="#matching">Matching</a></li><li><a href="#pretty-printers">Pretty Printers</a></li></ul></nav></header><aside><p>The engine tries to preserve physical equality whenever feasible. For example, if the trie <code>t</code> has a binding at <code>x</code>, the pattern <code>renaming [&quot;x&quot;] [&quot;x&quot;]</code> on <code>t</code> will return the same <code>t</code>.</p></aside><section><header><h2 id="matching"><a href="#matching" class="anchor"></a>Matching</h2></header><dl><dt class="spec value" id="val-run"><a href="#val-run" class="anchor"></a><code><span class="keyword">val</span> run : <span>?&#8288;rev_prefix:<a href="../Pattern/index.html#type-path">Pattern.path</a></span> <span>&#45;&gt;</span> <span>union:<span>(<span>rev_path:<a href="../Pattern/index.html#type-path">Pattern.path</a></span> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'a</span>)</span></span> <span>&#45;&gt;</span> <span>unit <a href="../Pattern/index.html#type-t">Pattern.t</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="../Trie/index.html#type-t">Trie.t</a></span> <span>&#45;&gt;</span> <span><span>(<span><span class="type-var">'a</span> <a href="../Trie/index.html#type-t">Trie.t</a></span>, <span>[&gt; <span>`BindingNotFound of <a href="../Pattern/index.html#type-path">Pattern.path</a></span> ]</span>)</span> Stdlib.result</span></code></dt><dd><p><code>run ~rev_prefix ~union pattern trie</code> runs the <code>pattern</code> on the <code>trie</code> and return the transformed trie.</p><dl><dt>parameter rev_prefix</dt><dd><p>The prefix prepended to any path sent to <code>union</code> and any path in the error reporting, but in reverse. The default is the empty unit path (<code>[]</code>).</p></dd></dl><dl><dt>parameter union</dt><dd><p>The resolver for two conflicting bindings sharing the same name. Patterns such as <a href="../Pattern/index.html#val-renaming"><code>Pattern.renaming</code></a> and <a href="../Pattern/index.html#val-union"><code>Pattern.union</code></a> could lead to conflicting bindings, and <code>union ~rev_path x y</code> should return the resolution of <code>x</code> and <code>y</code> at the (reversed) path <code>rev_path</code>.</p></dd></dl><dl><dt>returns</dt><dd><p>The new trie after the transformation. <code>Error (`BindingNotFound p)</code> means the transformation failed because of the absence of expected bindings. For example, the pattern <a href="../Pattern/index.html#val-except_subtree"><code>Pattern.except_subtree</code></a><code>[&quot;x&quot;; &quot;y&quot;]</code> expects that there was already something under the subtree at <code>x.y</code>. If there were actually no names with the prefix <code>x.y</code>, then the pattern will trigger the error <code>`BindingNotFound [&quot;x&quot;; &quot;y&quot;]</code>. The path is only an approximation---the user might have intended to hide the binding at <code>[&quot;x&quot;; &quot;y&quot;; &quot;z&quot;]</code>, a binding under <code>[&quot;x&quot;; &quot;y&quot;]</code>, but the engine would never know the user's true intension.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-run_with_custom"><a href="#val-run_with_custom" class="anchor"></a><code><span class="keyword">val</span> run_with_custom : <span>?&#8288;rev_prefix:<a href="../Pattern/index.html#type-path">Pattern.path</a></span> <span>&#45;&gt;</span> <span>union:<span>(<span>rev_path:<a href="../Pattern/index.html#type-path">Pattern.path</a></span> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'a</span>)</span></span> <span>&#45;&gt;</span> <span>custom:<span>(<span>rev_path:<a href="../Pattern/index.html#type-path">Pattern.path</a></span> <span>&#45;&gt;</span> <span class="type-var">'custom</span> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> option</span>)</span></span> <span>&#45;&gt;</span> <span><span class="type-var">'custom</span> <a href="../Pattern/index.html#type-t">Pattern.t</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="../Trie/index.html#type-t">Trie.t</a></span> <span>&#45;&gt;</span> <span><span>(<span><span class="type-var">'a</span> <a href="../Trie/index.html#type-t">Trie.t</a></span>, <span>[&gt; <span>`BindingNotFound of <a href="../Pattern/index.html#type-path">Pattern.path</a></span> ]</span>)</span> Stdlib.result</span></code></dt><dd><p><code>run_with_custom ~rev_prefix ~custom ~union pattern trie</code> runs the <code>pattern</code> on the <code>trie</code> and return the transformed trie. It is similar to <a href="index.html#val-run"><code>run</code></a> but accepts a new argument <code>custom</code>.</p><dl><dt>parameter custom</dt><dd><p>The customer filter that will be triggered by the pattern <a href="../Pattern/index.html#val-custom"><code>Pattern.custom</code></a><code>f</code>. When the engine encounters <a href="../Pattern/index.html#val-custom"><code>Pattern.custom</code></a><code>f</code>, it will call <code>custom ~rev_path:p f v</code> for all data <code>v</code> at <code>p</code> in the trie.</p></dd></dl></dd></dl></section><section><header><h2 id="pretty-printers"><a href="#pretty-printers" class="anchor"></a>Pretty Printers</h2></header><dl><dt class="spec value" id="val-pp_path"><a href="#val-pp_path" class="anchor"></a><code><span class="keyword">val</span> pp_path : Stdlib.Format.formatter <span>&#45;&gt;</span> <a href="../Pattern/index.html#type-path">Pattern.path</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>Pretty printer for <code>path</code>.</p></dd></dl></section></div></body></html>